worker_processes {{WORKER_PROCESSES}};

events {
    worker_connections  {{WORKER_CONNECTIONS}};
}

http {
    types {
        text/html                   html;
        text/css                    css;
        application/javascript      js;

        application/json            json;
        text/xml                    xml;
        text/plain                  txt;

        image/gif                   gif;
        image/jpeg                  jpeg jpg;
        image/png                   png;
        image/svg+xml               svg svgz;
        application/pdf             pdf;

        application/font-ttf        ttf;
        application/font-woff       woff;

        # REQUIRED for app cahce to work
        text/cache-manifest         appcache;
    }

    default_type  application/octet-stream;

    keepalive_timeout  65;

    gzip  on;
    gzip_types text/css application/javascript text/xml text/plain application/font-ttf text/cache-manifest;

    server {
        listen {{HTTP_PORT}};
        server_name localhost;

        access_log logs/access.log combined;
        error_log logs/error.log error;

        root www;

        location = / {
            index index.html;
        }

        location = /index.html {
            # REQUIRED to never cache index.html, so appcache will always work
            expires epoch;
        }

        location = /manifest.appcache {
            # REQUIRED to never cache the manifest, aso appcache will always work
            expires epoch;
        }

        location / {
            # REQUIRED to eliminate extra requests for everything else
            expires max;
        }
    }

}
